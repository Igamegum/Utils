---
title: "程序员的自我修养(第二章)"
tags: [笔记,程序员的自我修养]
---
## 编译过程
* #### 预编译
将源代码文件和头文件进行预编译
>gcc -E hello.c -o hello.i

<!--more-->


预编译主要是处理以<b>#</b>开始的预编译指令
1. 将所有的<b>#define</b> 删除，并且展开所有的宏定义
2. 处理所有的条件预编译指令
3. 递归处理<b>#include</b>预编译指令
4. 删除所有的注释
5. 添加行号和文件名标示，以便于编译器用于产生调试,警告，错误等信息
6. 保留所有的#pragma编译器指令



* #### 编译
编译就是将预处理文件进行一系列的词法分析，语法分析，语义分析及优化后生成相应的汇编代码
<b>gcc这个命令只是后台程序的包装，它会根据不同的参数要求取调用预编译编译程序cc1,汇编器as,链接器ld</b>
>gcc -S hello.c -o hello.s


* #### 汇编
汇编就是将汇编代码转变成机器可以执行的指令，每一个汇编语句几乎对应一条机器指令.
>as hello.s -o hello.o
或者
>gcc -c hello.s -o hello.o

* #### 链接
链接是一个比较复杂的过程

## 编译器
* #### 词法分析
将源代码中的符号提取出来

* #### 语法分析
将上一步采集到的符号进行语法分析，生成语法树

* #### 语义分析　
编译器所能分析的时静态语义，所谓静态语义是指在编译期可以确定的语义，与之对应的是动态语义．静态语义通常包括声明和类型的匹配，类型的转换．

* #### 中间代码优化
源代码优化器往往将整个语法树转换成中间代码，中间代码是的编译器可以被分为前端和后端．编译器前端负责产生机器无关的中间代码，编译器后端将中间代码转换成目标代码．这样对于一些可以跨平台的编译器而言，它们可以针对不同的平台使用同一个前端和针对不同机器平台的数个后端．


* #### 目标代码生成和优化
编译器后端主要包括代码生成器和目标代码优化器．
代码生成器将中间代码转换为目标代码十分依赖于目标机器．目标代码优化器对上述的目标代码进行优化，比如选择合适的寻址方式，使用位移来代替乘法运算，删除多余的指令等．


## 链接器
1. 重新计算各个目标的地址的过程被叫做<b>重定位</b>
2. <b>符号</b>被用来表示一个地址，这个地址可能是一段子程序的起始地址，也可能是一个变量的起始地址
3. 人们把每个源代码模块独立地编译，然后按照需要组装起来，这个组装模块的过程就是<b>链接</b>
4. 链接过程主要包括了<b>地址和空间分配</b>,<b>符号决议</b>和<b>重定位</b>等步骤．